(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7506,5054],{2601:function(e,t,n){"use strict";var a,o;e.exports=(null==(a=n.g.process)?void 0:a.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(8960)},7506:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var a=n(7437),o=n(2265),l=function(e){let t,{selectedImage:n,setSelectedImage:o}=e;t=n instanceof File?URL.createObjectURL(n):n;let l=()=>{o(void 0)};return(0,a.jsxs)("div",{className:"relative rounded p-2",children:[(0,a.jsx)("img",{src:t,alt:"your_image",onLoad:()=>URL.revokeObjectURL(t)}),(0,a.jsx)("div",{className:"btn btn-sm btn-circle absolute right-2 top-2",onClick:()=>l(),children:"âœ•"})]})},s=function(e){let{setSelectedImage:t}=e,n=e=>{e.target.files&&e.target.files.length>0&&/image/.test(e.target.files[0].type)?t(e.target.files[0]):toast.warn("Only accept images")};return(0,a.jsxs)("label",{htmlFor:"file",className:"cursor-pointer",children:[(0,a.jsx)("i",{className:"ri-image-line text-xl"}),(0,a.jsx)("input",{className:"hidden",type:"file",accept:"image/*",id:"file",name:"myfiles[]",onClick:e=>e.target.value=null,onChange:e=>n(e),multiple:!0})]})},c=n(6932),i=n(848);n(3979);var r=n(4897),u=n(6816),d=n(4016),m=n(171);let h=["sport","j4f","meme","important","event"];function v(e){let{className:t="",selectedText:n,setSelectedText:l}=e,[s,c]=(0,o.useState)(""),i=e=>[void 0,"insertFromYank","insertFromDrop","insertFromPasteAsQuotation","insertTranspose","insertCompositionText","insertLink"].includes(e),r=(e,t,n)=>{let{inputType:a}=e.nativeEvent,{value:o}=e.target;i(a)?null==t||t(o):null==n||n(o)},u=e=>{c(""),l([...n,e])},d=e=>c(e);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center w-full mt-2 py-2 px-4 border-neutral input rounded-full",children:[n.map((e,t)=>(0,a.jsx)("span",{className:"leading-8 badge badge-neutral mr-1",children:e},t)),(0,a.jsx)("input",{className:"flex-1 outline-none",list:"tags",name:"tag",id:"tag",value:s,onChange:e=>r(e,u,d)})]}),(0,a.jsx)("datalist",{id:"tags",children:h.map((e,t)=>(0,a.jsx)("option",{value:e},"tag-".concat(t)))})]})}var p=n(8625),f=function(e){var t,n;let{className:h="",isChannel:f=!1}=e,[g,b]=(0,o.useState)(!1),[x,P]=(0,o.useState)({name:"Select a channel",id:""}),[C,T]=(0,o.useState)(void 0),[Z,y]=(0,o.useState)(""),[w,j]=(0,o.useState)(!1),[E,N]=(0,o.useState)([]),S=(0,o.useRef)(null),{dataPosts:L,setLoadingAdd:I,setDataPosts:U}=(0,p.NV)(),{profile:A}=(0,p.LM)(),{channels:D,isLoading:_,isError:k}=u.Z.SearchChannelSchool("","",0,"",f),O=(0,c.jE)({extensions:[i.Z],content:""});if(!O)return null;let F=async()=>{j(!0),I(!0);let e=O.getText();if(0!==e.length||C){var t,n,a,o,l;let s=await (f?u.Z.CreatePostChannel(x.id,Z,e,E):d.Z.CreatePostSchool(Z,e,E));if(null==s?void 0:s.status){if(C&&await d.Z.UploadImagePost(null==s?void 0:null===(a=s.data)||void 0===a?void 0:null===(n=a.post)||void 0===n?void 0:n.uuid,C,""),!f){let e={comments:0,is_public:!0,last_comment:null,subject:Z,author:A,tags:E,thumps_up:0,uuid:null==s?void 0:null===(l=s.data)||void 0===l?void 0:null===(o=l.post)||void 0===o?void 0:o.uuid},t={count:L.count+1,results:[e,...L.results]};U(t)}m.toast.success((null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||(null==s?void 0:s.message))}else m.toast.error(null==s?void 0:s.message);T(void 0),j(!1),I(!1)}else m.toast.warn("Content is empty"),j(!1)};return(0,a.jsxs)(r.Z,{className:"btn btn-sm btn-primary hover:text-base-300 rounded-full ".concat(h),classNameForm:"overflow-y-visible px-0 pt-0",classNameFooter:"mr-6 mt-4",title:"New Post",handleSubmit:F,children:[(0,a.jsxs)("div",{className:"p-6 pb-3 max-h-96 ".concat(C&&"overflow-auto"),children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:"Create A Post"}),f&&(0,a.jsxs)("details",{className:"dropdown",ref:S,children:[(0,a.jsxs)("summary",{tabIndex:"0",className:"list-none cursor-pointer my-auto whitespace-nowrap font-medium text-sm hover:text-accent-focus",children:[x.name,(0,a.jsx)("i",{className:"ri-arrow-drop-down-line"})]}),(0,a.jsx)("ul",{tabIndex:"0",className:"z-50 overflow-y-scroll max-h-56 dropdown-content menu block shadow-lg bg-base-100 rounded-md",children:(null==D?void 0:null===(t=D.results)||void 0===t?void 0:t.length)>0?null==D?void 0:null===(n=D.results)||void 0===n?void 0:n.map((e,t)=>(0,a.jsx)("li",{className:"flex items-center py-1",children:(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("i",{className:"ri-hashtag text-2xl"}),(0,a.jsx)("button",{className:"capitalize hover:text-accent-focus",onClick:()=>{S.current.removeAttribute("open"),P({id:e.id,name:e.name})},children:e.name})]})},"channel-".concat(t))):(0,a.jsx)("li",{className:"flex items-center py-1",children:(0,a.jsx)("div",{className:"w-full",children:"No channel in this school"})})})]}),(0,a.jsx)(c.kg,{editor:O,required:!0,className:"my-2 text-base overflow-y-auto w-full bg-transparent"}),C&&(0,a.jsx)(l,{selectedImage:C,setSelectedImage:T})]}),(0,a.jsx)("div",{className:"px-5 py-4 space-x-5 bg-neutral",children:(0,a.jsx)(s,{setSelectedImage:T})}),(0,a.jsxs)("div",{className:"py-3 px-4 flex flex-col",children:[(0,a.jsx)("label",{className:"text-sm font-medium inline",htmlFor:"title",children:"Title"}),(0,a.jsx)("input",{className:"w-full mt-2 py-2 px-4 border-neutral input h-auto rounded-full",name:"title",id:"title",value:Z,required:!0,onChange:e=>y(e.target.value)})]}),(0,a.jsxs)("div",{className:"py-3 px-4 flex flex-col",children:[(0,a.jsx)("label",{className:"text-sm font-medium inline",htmlFor:"tag",children:"Message Tags"}),(0,a.jsx)(v,{selectedText:E,setSelectedText:N})]})]})}},6816:function(e,t,n){"use strict";var a=n(6457),o=n(7217),l=n(713),s=n(2601);t.Z={GetDetailCommentChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channel/").concat(e,"/comments/").concat(t),{data:s,isLoading:c}=(0,l.ZP)(n,o.Z);return{detail_comment:s,isLoading:c,isError:(null==s?void 0:s.status)===!1?null==s?void 0:s.message:""}},SearchChannelSchool:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c=!(arguments.length>4)||void 0===arguments[4]||arguments[4],i="".concat(a.bl,"/api/v1/channels/search?ordering=").concat(e,"&limit=").concat(t,"&offset=").concat(n,"&q=").concat(s),{data:r,isLoading:u}=(0,l.ZP)(c?i:null,o.Z);return{channels:null==r?void 0:r.data,isLoading:u,isError:(null==r?void 0:r.status)===!1?null==r?void 0:r.message:""}},SearchMemberChannel:function(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c="".concat(a.bl,"/api/v1/channels/").concat(e,"/members/search?limit=").concat(t,"&offset=").concat(n,"&q=").concat(s),{data:i,isLoading:r}=(0,l.ZP)(c,o.Z);return{members:i,isLoading:r,isError:(null==i?void 0:i.status)===!1?null==i?void 0:i.message:""}},ListPinnedPostsChannel:(e,t,n)=>{let s="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts-pinned?limit=").concat(t,"&offset=").concat(n),{data:c,isLoading:i,mutate:r}=(0,l.ZP)(s,o.Z);return{pinPosts:null==c?void 0:c.data,isLoading:i,isError:(null==c?void 0:c.status)===!1?null==c?void 0:c.message:"",mutate:r}},SearchPostChannel:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",c="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts/search?limit=").concat(t,"&offset=").concat(n,"&q=").concat(s),{data:i,isLoading:r,mutate:u}=(0,l.ZP)(c,o.Z);return{posts:null==i?void 0:i.data,isLoading:r,isError:(null==i?void 0:i.status)===!1?null==i?void 0:i.message:"",mutate:u}},CreateChannelSchool:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="".concat(a.bl,"/api/v1/channels/");return(0,o.Z)(l,"POST",{name:e,description:t,is_private:n})},InviteUsersChannel:(e,t,n)=>{let l="".concat(a.bl,"/api/v1/channels/").concat(e,"/invitations");return(0,o.Z)(l,"POST",{members:t,message:n})},CreatePostChannel:(e,t,n,l)=>{let s="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts");return(0,o.Z)(s,"POST",{subject:t,content:n,tags:l})},RequestJoinChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e,"/request");return(0,o.Z)(n,"POST",{message:t})},UpdateCommentChannel:(e,t,n,l,s,c)=>{let i="".concat(a.bl,"/api/v1/channel/").concat(e,"/comments/").concat(t);return(0,o.Z)(i,"PUT",{content:n,author:l,status:s,parent:c})},UpdateChannel:(e,t,n)=>{let l="".concat(a.bl,"/api/v1/channels/").concat(e);return(0,o.Z)(l,"PUT",{name:t,description:n})},PinPostChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts/pinned/").concat(t);return(0,o.Z)(n,"PUT")},AcceptRequestJoinChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e,"/request/").concat(t);return(0,o.Z)(n,"PUT")},PartialUpdateCommentChannel:(e,t,n,l,s,c)=>{let i="".concat(a.bl,"/api/v1/channel/").concat(e,"/comments/").concat(t);return(0,o.Z)(i,"PATCH",{content:n,author:l,status:s,parent:c})},ChangeStatusChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e);return(0,o.Z)(n,"PATCH",{status:t})},JoinUsersChannel:e=>{let t="".concat(a.bl,"/api/v1/channels/").concat(e,"/invitations");return(0,o.Z)(t,"PATCH")},UpdatePostChannel:(e,t,n,l,s,c)=>{let i="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts/").concat(t);return(0,o.Z)(i,"PATCH",{subject:n,content:l,is_public:s,tags:c})},DestroyCommentChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channel/").concat(e,"/comments/").concat(t);return(0,o.Z)(n,"DELETE")},RemoveChannel:e=>{let t="".concat(a.bl,"/api/v1/channels/").concat(e);return(0,o.Z)(t,"DELETE")},RejectChannel:e=>{let t="".concat(a.bl,"/api/v1/channels/").concat(e,"/invitations");return(0,o.Z)(t,"DELETE")},RemovePinPostChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts/pinned/").concat(t);return(0,o.Z)(n,"DELETE")},DeletePostChannel:(e,t)=>{let n="".concat(a.bl,"/api/v1/channels/").concat(e,"/posts/").concat(t);return(0,o.Z)(n,"DELETE")},ListChannel:e=>{let t="".concat(s.env.NEXT_PUBLIC_BASIC_API_ENDPOINT,"/channels?_page=").concat(e,"&_limit=6"),{data:n,isLoading:a}=(0,l.ZP)(t,o.Z);return{channels:n,isLoading:a,isError:(null==n?void 0:n.status)===!1?null==n?void 0:n.message:""}}}},4016:function(e,t,n){"use strict";var a=n(6457),o=n(7217),l=n(713),s=n(2601);t.Z={ListPinPostForSchool:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1?arguments[1]:void 0,n="".concat(a.bl,"/api/v1/posts-pinned?limit=").concat(e,"&offset=").concat(t),{data:s,isLoading:c}=(0,l.ZP)(n,o.Z);return{pinPosts:null==s?void 0:s.data,isLoading:c,isError:(null==s?void 0:s.status)===!1?null==s?void 0:s.message:""}},SearchPostSchool:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",s="".concat(a.bl,"/api/v1/posts/search?limit=").concat(e,"&offset=").concat(t,"&q=").concat(n),{data:c,isLoading:i}=(0,l.ZP)(s,o.Z);return{posts:null==c?void 0:c.data,isLoading:i,isError:(null==c?void 0:c.status)===!1?null==c?void 0:c.message:""}},GetDetailPost:e=>{let t="".concat(a.bl,"/api/v1/posts/").concat(e),{data:n,isLoading:s,mutate:c}=(0,l.ZP)(t,o.Z);return{post:null==n?void 0:n.data,isLoading:s,isError:(null==n?void 0:n.status)===!1?null==n?void 0:n.message:"",mutate:c}},ListCommentPost:(e,t,n)=>{let s="".concat(a.bl,"/api/v1/posts/").concat(e,"/comments?limit=").concat(t,"&offset=").concat(n),{data:c,isLoading:i}=(0,l.ZP)(s,o.Z);return{comments_post:null==c?void 0:c.data,isLoading:i,isError:(null==c?void 0:c.status)===!1?Object.values(null==c?void 0:c.error)[0]:""}},CreatePostSchool:(e,t,n)=>{let l="".concat(a.bl,"/api/v1/posts");return(0,o.Z)(l,"POST",{subject:e,content:t,tags:n})},UploadImagePost:(e,t,n)=>{let l="".concat(a.bl,"/api/v1/posts/").concat(e,"/image"),s=new FormData;return s.append("image",t),s.append("caption",n),(0,o.Z)(l,"POST",{files:s},{"Content-Type":"multipart/form-data"})},CreateLocationPost:(e,t,n,l,s)=>{let c="".concat(a.bl,"/api/v1/post/").concat(e,"/location");return(0,o.Z)(c,"PUT",{primary_street_name:t,secondary_street_name:n,primary_location:l,secondary_location:s})},PinPostSchool:e=>{let t="".concat(a.bl,"/api/v1/posts/pinned/").concat(e);return(0,o.Z)(t,"PUT")},LikePost:e=>{let t="".concat(a.bl,"/api/v1/posts/").concat(e,"/");return(0,o.Z)(t,"PUT")},RemovePinPostSchool:e=>{let t="".concat(a.bl,"/api/v1/posts/pinned/").concat(e);return(0,o.Z)(t,"DELETE")},RemoveLikePost:e=>{let t="".concat(a.bl,"/api/v1/posts/").concat(e,"/");return(0,o.Z)(t,"DELETE")},TotalPost:()=>{let e="".concat(s.env.NEXT_PUBLIC_BASIC_API_ENDPOINT,"/stats");return(0,o.Z)(e)}}},5039:function(e,t,n){"use strict";var a=n(5484);t.Z={getItem:async e=>(0,a.U2)(e).then(e=>e).catch(e=>{}),setItem:async(e,t)=>{await (0,a.t8)(e,t)},removeItem:async e=>{await (0,a.IV)(e)}}},6457:function(e,t,n){"use strict";n.d(t,{Cx:function(){return a},DN:function(){return o},MI:function(){return u},Pm:function(){return s},bl:function(){return l},dr:function(){return i},hp:function(){return c},nj:function(){return r}});let a="AfBMQbX0e68dTTyZbmn8oC9UL5zPdZAaf4XwU1mR",o="G0sBIyaqex7g67FSDIFyJqeBdxyo8Msg4fUxnqeAAX22xwH6KMeVLQwJRox34HJvMxdV1PPyxMBdnFBPk7DD3IByCJtL6MhOojcCJSDWGIC5OqFm0AlhcsA7fTIeDqsP",l="https://api-dev.koolyard.com",s=10,c=5,i=5,r=5,u=[{label:"Newest channel",field:"created"},{label:"Oldest channel",field:"-created"},{label:"Most members",field:"members"},{label:"Fewest members",field:"-members"},{label:"A to Z",field:"name"},{label:"Z to A",field:"-name"}]},7217:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var a=n(5039);async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l={method:t?String(t||"").toUpperCase():"GET"};"GET"!==l.method&&(n.files?l.body=n.files:l.body=JSON.stringify(n||{})),l.headers={"Content-Type":"application/json",...o},n.files&&delete l.headers["Content-Type"];let s=await a.Z.getItem("forumUser");if(s){var c;let e=JSON.parse(s),t=null==e?void 0:null===(c=e.state)||void 0===c?void 0:c.access;t&&(l.headers.Authorization="Bearer ".concat(t))}return fetch(e,l).then(e=>(403===e.status?window&&(window.location.href="/error/403/"):404===e.status?window&&(window.location.href="/error/404/"):401===e.status&&a.Z.removeItem("forumUser"),e.json()))}},8960:function(e){!function(){var t={229:function(e){var t,n,a,o=e.exports={};function l(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function c(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var i=[],r=!1,u=-1;function d(){r&&a&&(r=!1,a.length?i=a.concat(i):u=-1,i.length&&m())}function m(){if(!r){var e=c(d);r=!0;for(var t=i.length;t;){for(a=i,i=[];++u<t;)a&&a[u].run();u=-1,t=i.length}a=null,r=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.push(new h(e,t)),1!==i.length||r||c(m)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var l=n[e]={exports:{}},s=!0;try{t[e](l,l.exports,a),s=!1}finally{s&&delete n[e]}return l.exports}a.ab="//";var o=a(229);e.exports=o}()}}]);